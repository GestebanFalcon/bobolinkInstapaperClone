!function(e,t){if("object"==typeof exports&&"object"==typeof module)module.exports=t();else if("function"==typeof define&&define.amd)define([],t);else{var n=t();for(var r in n)("object"==typeof exports?exports:e)[r]=n[r]}}(window,(function(){return n={},e.m=t=[function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isValidFunction=t.getPropertyValue=t.isPropertyOfType=t.detectStringOrNumberValueMismatch=t.detectArrayValuesMismatch=t.isDesktop=t.isNullOrUndefined=t.isChromeFamily=t.sample=t.detachAllHandlers=t.setInterval=t.setTimeout=t.getFnName=t.isImplNative=t.getHighestAccessibleWindow=t.getErrorReporter=t.setErrorReporter=t.getEventUtils=t.setEventUtils=void 0;var r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o=n(3),i=null,c={},s={},u=-1!==window.location.href.indexOf("csm_debug_mode"),l=[9,16,21,30];t.setEventUtils=function(e){c=e},t.getEventUtils=function(){return c},t.setErrorReporter=function(e){s=e},t.getErrorReporter=function(){return s},t.getHighestAccessibleWindow=function(){return i=i||function(){for(var e=window,t=!1,n=0;e!==top&&e.parent&&e!=e.parent&&!1===t&&n<=10;)try{n++;var r=e.parent;r.document&&r.document.body&&r.document.body.innerHTML&&(e=e.parent)}catch(e){t=!0;break}return e}()},t.isImplNative=function(e){try{var t=new RegExp("\\{\\s*\\[native code\\]\\s*\\}","m");return t.test(e.toString())&&t.test(Function.prototype.toString.call(e))&&t.test(Function.prototype.toString.toString.call(e))&&t.test(Function.prototype.toString.toString.toString.call(e))}catch(e){return!1}},t.getFnName=function(e){for(var t="",n=0;n<l.length;n++)t+="TmIENvZGUaF0aXZlt98s7oshd4ERdsbaytYuY/".charAt(l[n]);return window[t](e)},t.setTimeout=function(e,t){return window.setTimeout((function(){try{e.call()}catch(e){e.message&&o.amzncsm.log("Error: "+e.message),s.reportError(e)}}),t)},t.setInterval=function(e,t){return window.setInterval((function(){try{e.call()}catch(e){e.message&&o.amzncsm.log("Error: "+e.message),s.reportError(e)}}),t)},t.detachAllHandlers=function(){for(var e,t=0;t<c.eventHandlers.length;t++)e=c.eventHandlers[t],c.removeEvent(e.elem,e.eventName,e.cb)},t.sample=function(e,t){if("function"==typeof e){var n=Math.random();(u||n<t/100)&&e.call(self)}},t.isChromeFamily=function(){var e=window.navigator,t=e.vendor,n=void 0!==window.opr,r=-1<e.userAgent.indexOf("Edge"),o=/Chrome/.test(e.userAgent);return/Google Inc\./.test(t)&&o&&!n&&!r},t.isNullOrUndefined=function(e){try{for(var t=Array.prototype.slice.call(arguments,1),n=0;n<t.length;n++){if(!e)return!0;var r=e[t[n]];if(null==r)return!0;e=r}return!1}catch(e){return!0}},t.isDesktop=function(){return null===navigator.userAgent.match(/(iPad|iPhone|iPod|android|webOS)/i)},t.detectArrayValuesMismatch=function(e,t){var n=!1;return!(!e&&!t)&&(e&&t?e.length!==t.length?n=!0:0<e.length&&0<t.length&&"string"==typeof e[0]&&e[0]!==t[0]&&(n=!0):n=!0,n)},t.detectStringOrNumberValueMismatch=function(e,t){return!(!e&&!t)&&e!==t},t.isPropertyOfType=function(e,t){try{if(!e)return!1;for(var n=Array.prototype.slice.call(arguments,2),o=0;o<n.length;o++){var i=e[n[o]];if(null==i)return o===n.length-1&&(void 0===i?"undefined":r(i))===t;e=i}return("undefined"==typeof propValue?"undefined":r(propValue))===t}catch(e){return!1}},t.getPropertyValue=function(e){try{if(!e)return e;for(var t,n=Array.prototype.slice.call(arguments,1),r=0;r<n.length;r++){if(!(t=e[n[r]]))return t;e=t}return t}catch(e){return null}},t.isValidFunction=function(e){return null!=e&&"function"==typeof e}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getErrorHandler=a,t.reportError=function(e){a().reportError(e)};var r=n(0),o=n(3),i=n(6),c=(0,r.getHighestAccessibleWindow)(),s=null;function u(e){o.amzncsm.log(e)}var l=function(e){s=new i.HandleExceptions(e),c[s]=s};function a(){return s||(l(u),s)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.LIBRARY_VERSION="1.0.0",t.VFRD_CODE_HEADLESS_BROWSER=4,t.VFRD_CODE_HEADLESS_BROWSER_TEST=8,t.HEADLESS_CODE_CHROME="chrm",t.HEADLESS_CODE_CHROME_OBJECT_INTERNALS_AVAIL="chrm1",t.HEADLESS_CODE_CHROME_OBJECT_MISSING="chrm2",t.HEADLESS_CODE_CHROME_INSTALL="chrm3",t.HEADLESS_CODE_FF="ffox",t.HEADLESS_CODE_PHANTOMJS="phnt",t.HEADLESS_CODE_MOUSE_MOVEMENT_IN_HIDDEN_TAB="mmh",t.HEADLESS_CODE_ZERO_WINDOW_DIMENSION="zdim",t.HEADLESS_CODE_SINGLE_TOUCH_POINTS="otch",t.ERROR_BASED_TOOLKIT_DETECTION="estr",t.HARDWARE_CONCURRENCY_MISMATCH="spfp2",t.FORENSICS_OBJECT="forensics",t.ZONE_REGION_MAP={USEast:"na","US-PDX":"na","US-IAD":"na",EU:"eu","FE-SIN":"fe","FE-PDX":"fe"},t.TUNGSTEN_TENANTS={forensics3PCsmEvent:"3pCsmEvent",forensicsTwitchCsmEvent:"twitchCsmEvent",forensicsImdbCsmEvent:"imdbCsmEvent",forensicsDefaultCsmEvent:"defaultCsmEvent"},t.VFRD_CODES={APS_VFRD_CODE:21,_3PX_VFRD_CODE:22,TWITCH_VFRD_CODE:23,IMDB_VFRD_CODE:24,DEFAULT_VFRD_CODE:25},t.SOURCE_IDS={TWITCH_SOURCE_IDS:["650","651","652","654"],IMDB_SOURCE_IDS:["204"]},t.SOURCE_TYPE={APS_SOURCE_TYPE:"dtb",_3PX_SOURCE_TYPE:"rtb"},t.MAX_DEPTH=3,t.VFRD_CODE=21,t.CSM_VERSION="r-1.31",t.SSI_CSM_VERSION="ccf-1.0"},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=t.amzncsm=r||{};r.log=function(e){try{-1!==window.location.href.indexOf("csm_debug_mode")&&window.console&&window.console.log(e)}catch(e){window.console.log(e.message)}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.addSSITungstenPixel=t.addNexusPixel=t.addErrorPixel=t.init=t.addPixel=void 0;var r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o=n(2),i=n(3),c=!1,s={},u={};t.addPixel=function(e,t,n){var l,a,f,d=(l=e,a=n,f={vfrd:1===t?o.VFRD_CODE_HEADLESS_BROWSER_TEST:o.VFRD_CODE_HEADLESS_BROWSER,dbg:l},"object"===(void 0===a?"undefined":r(a))?f.info=JSON.stringify(a):"string"==typeof a?f.info=a:"number"==typeof a&&(f.info=a.toString()),f);if(window.RUNNING_TESTS&&TEST_IDS.push(d),!s.allowOnlyOneVfrdPixel||!c){i.amzncsm.log("Pixel = "+JSON.stringify(d));var E=u.addPixel,S=void 0===E?function(){}:E,_=u.logForensicsCsmEventToTungsten,p=void 0===_?function(){}:_;S.call(u,d),p.call(u,d),c=!0}},t.init=function(e,t){u=e,s=t},t.addErrorPixel=function(e){window.RUNNING_TESTS&&TEST_IDS.push(e),i.amzncsm.log("Pixel = "+JSON.stringify(e));var t=u.firePixel,n=void 0===t?function(){}:t,r=u.logForensicsCsmEventToTungsten,o=void 0===r?function(){}:r;n.call(u,JSON.stringify(e),"");var c=e.adViewability[0].error;return o.call(u,c,!0),!0},t.addNexusPixel=function(e,t,n){var r=window.ue_csm,o={server:window.location.hostname,fmp:e};r&&r.ue&&r.ue.event&&r.ue.event(o,t,n)},t.addSSITungstenPixel=function(e,t){try{var n={vfrd:e,dbg:JSON.stringify(t)};window.RUNNING_TESTS&&TEST_IDS.push(n),i.amzncsm.log("Pixel = "+JSON.stringify(n)),u.addPixel;var r=u.logForensicsCsmEventToTungsten;(void 0===r?function(){}:r).call(u,n)}catch(e){i.amzncsm.log("error logging pixel "+JSON.stringify(t))}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.deleteForensicsObject=t.addObjToForensicsObj=void 0;var r=n(0),o=n(1),i=n(2),c=(0,r.getHighestAccessibleWindow)();t.addObjToForensicsObj=function(e,t){try{var n=c[i.FORENSICS_OBJECT]||{};n[e]=t,c[i.FORENSICS_OBJECT]=n}catch(e){(0,o.reportError)(e)}},t.deleteForensicsObject=function(){c[i.FORENSICS_OBJECT]=null,delete c[i.FORENSICS_OBJECT]}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.HandleExceptions=void 0;function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var o=n(0),i=n(3);function c(e){return e}function s(e,t){var n=1<arguments.length&&void 0!==t?t:"";return e.m&&e.m.message?n+=e.m.message:e.m&&e.m.target&&e.m.target.tagName?n+="Error handler invoked by "+e.m.target.tagName+" tag":e.m?n+=e.m:e.message?n+=e.message:n+="Unknown error",n}var u=(0,o.getHighestAccessibleWindow)();function l(e){i.amzncsm.log(e)}function a(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,a),this._shouldLogToConsole=!1,this._consoleString="console",this._errorString="error",this._extractErrorMessage=s,this._buildErrorPixel=c,(0,o.isValidFunction)(e)?this._logErrorPixel=e:this._logErrorPixel=l}t.HandleExceptions=(function(e,t,n){t&&r(e.prototype,t),n&&r(e,n)}(a,[{key:"setShouldLogToConsole",value:function(e){this._shouldLogToConsole=!0===e}},{key:"setConsoleString",value:function(e){this._consoleString=e}},{key:"setErrorString",value:function(e){this._errorString=e}},{key:"setExtractErrorMessage",value:function(e){(0,o.isValidFunction)(e)&&(this._extractErrorMessage=e)}},{key:"setBuildErrorPixel",value:function(e){(0,o.isValidFunction)(e)&&(this._buildErrorPixel=e)}},{key:"setLogErrorPixel",value:function(e){(0,o.isValidFunction)(e)&&(this._logErrorPixel=e)}},{key:"consoleLog",value:function(e){u[this.console_string][this.error_string](e)}},{key:"reportError",value:function(e,t){var n=1<arguments.length&&void 0!==t?t:"";try{var r=this._extractErrorMessage(e,n),o=this._buildErrorPixel(r);this.shouldLogToConsole&&this.consoleLog(e),this._logErrorPixel(o)}catch(e){this._logErrorPixel(e)}}}]),a)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ecclCSMAttributes=void 0;var r=n(8),o=n(9),i=n(0),c=n(5),s=n(1);t.ecclCSMAttributes=function(e,t,n,u,l,a,f){try{if(!(0,i.isValidFunction)(f))throw new Error("logger is null or not a function");var d={};(0,i.isValidFunction)(t)&&t(),d=(0,i.isValidFunction)(n)?n(e):(0,r.collectWithSchemaHavingNestedObjects)(e,null,null,0,a),(0,c.deleteForensicsObject)(),(0,i.isValidFunction)(u)?d=u(d,e):l&&(d=(0,o.compressWithSchemaNestedObjects)(d,e,null,0,a)),f(d)}catch(e){(0,s.reportError)(e)}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.collectWithSchemaHavingNestedObjects=void 0;var r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o=n(0),i=n(1),c=(0,o.getHighestAccessibleWindow)();t.collectWithSchemaHavingNestedObjects=function e(t,n,o,s,u){var l=n||c,a=o||t,f={};try{if(u<s)return{};var d=void 0;Object.keys(a).forEach((function(n){"object"!==(void 0===(d=a[n])?"undefined":r(d))||Array.isArray(d)?f[n]=l[n]:null==l[n]?f[n]=null:f[n]=e(t,l[n],a[n],s+1,u)}))}catch(n){(0,i.reportError)(n)}return f}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.compressWithSchemaNestedObjects=void 0;var r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o=n(1);t.compressWithSchemaNestedObjects=function e(t,n,i,c,s){var u=[];try{if(s<=c)return[];var l=i||n,a=Object.keys(l),f=0;a.forEach((function(o){if("object"!=r(l[o])||null==l[o]||Array.isArray(l[o]))switch(!0){case!0===t[o]:u[f]=1;break;case!1===t[o]:case 0===t[o]:u[f]=0;break;case null!=t[o]:u[f]=t[o];break;default:u[f]=null}else null!=t[o]?u[f]=e(t[o],n,l[o],c+1):u[f]=e({},n,l[o],c+1);f+=1}))}catch(i){(0,o.reportError)(i)}return u}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=t.getTagstoneParameterByKey=function(e){var t="undefined"!=typeof window?window.document:document;if(!t||!t.currentScript||!t.currentScript.src)throw new Error("Error accessing current script source");var n=new URL(t.currentScript.src);return new URLSearchParams(n.search).get(e)};t.getBidId=function(){return r("bidId")},t.getZone=function(){return r("zone")},t.getSourceId=function(){return r("sourceid")},t.getSourceType=function(){return r("sourcetype")}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.log=t.postRequest=t.logToTungsten=t.logWithNexus=void 0;var r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o=n(4),i=n(1),c=n(10),s=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(2));t.logWithNexus=function(e,t,n,c,s,u){try{var l={vfrd:1===t?c:n};"object"===(void 0===e?"undefined":r(e))?l.info=JSON.stringify(e):"string"==typeof e?l.info=e:"number"==typeof e&&(l.info=e.toString()),(0,o.addNexusPixel)(l,s,u)}catch(e){return(0,i.reportError)(e),!1}return!0},t.logToTungsten=function(e,t,n){var r=2<arguments.length&&void 0!==n&&n;try{var o=u(t,r),i=l(e);a(i,o,(function(e){f(e.message)}))}catch(e){f(e.message)}};var u=function(e,t){var n=1<arguments.length&&void 0!==t&&t,r=s.SSI_CSM_VERSION,o=(0,c.getBidId)();if(!o)throw new Error("bidId is not defined");return[{ver:r,ts:(new Date).getTime(),error:n?1:0,bidId:o,fmp:e}]},l=function(e){var t=(0,c.getZone)();if(!t)throw new Error("Zone is not defined");var n=s.ZONE_REGION_MAP[t];if(!n)throw new Error("Region is not defined");return"https://tungsten-service.prod."+n+".adsqtungsten.a9.amazon.dev/csm/"+e},a=t.postRequest=function(e,t,n){fetch(e,{cache:"no-cache",method:"POST",body:JSON.stringify(t),headers:new Headers({"Content-Type":"application/json"})}).then((function(e){if(200!==e.status)throw new Error("Tungsten returned response status: "+e.status)})).catch((function(e){n&&n(e)}))},f=t.log=function(e){try{-1!==window.location.href.indexOf("csm_debug_mode")&&window.console&&window.console.log(e)}catch(e){window.console.log(e.message)}}},,,,,,,,,,,,,,function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.init=void 0;var r=n(7),o=n(26),i=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(2)),c=n(1),s=n(11),u=n(27),l=n(28);function a(e){var t={vfrd:(0,u.getVFRDBasedOnSupply)(),dbg:e};(0,s.logToTungsten)((0,l.getTenantBasedOnSupply)(),t)}function f(e){var t={m:e};(0,s.logToTungsten)((0,l.getTenantBasedOnSupply)(),t,!0)}function d(){try{(0,c.getErrorHandler)().setLogErrorPixel(f),(0,r.ecclCSMAttributes)(o.csmAttribute,null,null,null,!0,i.MAX_DEPTH,a)}catch(e){(0,c.reportError)(e)}}d(),t.init=d},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.csmAttribute={screen:{availHeight:0,availWidth:0,width:0,height:0,colorDepth:0,pixelDepth:0,orientation:{angle:0,onchange:0}},navigator:{appCodeName:"",appName:"",appVersion:"",deviceMemory:0,doNotTrack:0,hardwareConcurrency:0,language:"",maxTouchPoints:0,product:"",productSub:0,vendor:"",vendorSub:"",userAgent:"",languages:[],platform:"",webdriver:0}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getVFRDBasedOnSupply=void 0;var r=n(10),o=n(2);t.getVFRDBasedOnSupply=function(){var e=(0,r.getSourceId)(),t=(0,r.getSourceType)();return-1!==o.SOURCE_IDS.TWITCH_SOURCE_IDS.indexOf(e)?o.VFRD_CODES.TWITCH_VFRD_CODE:-1!==o.SOURCE_IDS.IMDB_SOURCE_IDS.indexOf(e)?o.VFRD_CODES.IMDB_VFRD_CODE:o.SOURCE_TYPE._3PX_SOURCE_TYPE===t?o.VFRD_CODES._3PX_VFRD_CODE:o.SOURCE_TYPE.APS_SOURCE_TYPE===t?o.VFRD_CODES.APS_VFRD_CODE:o.VFRD_CODES.DEFAULT_VFRD_CODE}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getTenantBasedOnSupply=void 0;var r=n(10),o=n(2);t.getTenantBasedOnSupply=function(){var e=(0,r.getSourceId)(),t=(0,r.getSourceType)();return-1!==o.SOURCE_IDS.TWITCH_SOURCE_IDS.indexOf(e)?o.TUNGSTEN_TENANTS.forensicsTwitchCsmEvent:-1!==o.SOURCE_IDS.IMDB_SOURCE_IDS.indexOf(e)?o.TUNGSTEN_TENANTS.forensicsImdbCsmEvent:o.SOURCE_TYPE.APS_SOURCE_TYPE===t?o.TUNGSTEN_TENANTS.forensics3PCsmEvent:o.SOURCE_TYPE._3PX_SOURCE_TYPE===t?o.TUNGSTEN_TENANTS.forensics3PCsmEvent:o.TUNGSTEN_TENANTS.forensicsDefaultCsmEvent}}],e.c=n,e.d=function(t,n,r){e.o(t,n)||Object.defineProperty(t,n,{enumerable:!0,get:r})},e.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},e.t=function(t,n){if(1&n&&(t=e(t)),8&n)return t;if(4&n&&"object"==typeof t&&t&&t.__esModule)return t;var r=Object.create(null);if(e.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:t}),2&n&&"string"!=typeof t)for(var o in t)e.d(r,o,function(e){return t[e]}.bind(null,o));return r},e.n=function(t){var n=t&&t.__esModule?function(){return t.default}:function(){return t};return e.d(n,"a",n),n},e.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},e.p="",e(e.s=25);function e(r){if(n[r])return n[r].exports;var o=n[r]={i:r,l:!1,exports:{}};return t[r].call(o.exports,o,o.exports,e),o.l=!0,o.exports}var t,n}));